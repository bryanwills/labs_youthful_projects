Algorithms adapted from:
http://www.codeproject.com/KB/GDI-plus/displacementfilters.aspx