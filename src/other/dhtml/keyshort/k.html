<html>
<head>
<title>Testing</title>
<script language="JavaScript">
keys = {};
gk = {};

</script>
<script language="JavaScript" src="vstudio.js"></script>
<script language="JavaScript" src="keyboard.js"></script>
<script language="JavaScript">
modifierstyle = 'normal';
function Debug(str) { debug.value= str; }
function loadmode(nmode)
{
	if (!gk) { alert('Different modes are not enabled for this map.'); return;	}
	if (!gk[nmode]) { alert('No shortcuts for this mode?'); return;	}
	keys = gk[nmode];
	populate('normal');
	
}
function test()
{
//alert('here i am  ' + keys.a.control.doc);

//populate("control");
alert(divmode.innerHTML);
//alert(keys[);
}
i = 0;
function changei()
{
i = prompt('Pick i');
}
function recordkey(e)
{
	if (!e) var e = window.event;
	var n =  e.keyCode;
	/*for (a in e) divout+=a;
	out.value+= "\r\n" +  e.keyCode + ":" + i;
	i++;*/
	
	//var t = keymap[eventmapkeydown[n]];
	//if (t) out.value = 'You pressed the key called:' + t[0];
	//out.value += "\r\n" + n;
	
	var cellid = eventmapkeydown[n];
	if (cellid) presskey( cellid );
	
	
	if (keymodifiers[n])
	{
		presskey(keymodifiers[n][1], true);
		presskey(keymodifiers[n][2], true);
		setstyle (e.ctrlKey, e.shiftKey, e.altKey);
	}
	else
	{
		var nK = cellid;
		var style = getstyle(e.ctrlKey, e.shiftKey, e.altKey);
		var ar = getdoc(style, nK);
		if (! ar) divdoc.innerHTML = '';
		else 
		{
		var rendershortcut = renderstyle(e.ctrlKey,e.shiftKey, e.altKey)+keymap[nK][0];
		divdoc.innerHTML = createdoc(  ar[0], rendershortcut, ar[1],  ar[2]);
		}
	}
	if (window.event) window.event.cancelBubble = true;
	//~ e.cancelBubble = true;
	//~ if (e.stopPropagation) e.stopPropagation();
	if (e.preventDefault) e.preventDefault();
	if (e.stopPropagation) e.stopPropagation();
	return false;
}

function recordkeyup(e)
{
	if (!e) var e = window.event;
	var n =  e.keyCode;
	if (keymodifiers[n])
	{
		unpresskey(keymodifiers[n][1]);
		unpresskey(keymodifiers[n][2]);
		setstyle (e.ctrlKey, e.altKey, e.shiftKey);
	}
	keycapture.value = '';
	if (e.preventDefault) e.preventDefault();
	if (e.stopPropagation) e.stopPropagation();
	return false;
}
function presskey(nK, bStay)
{
	var o = document.getElementById('cell'+nK);
	o.className = 'pressed';
	if (!bStay) setTimeout('unpresskey('+nK+')', 300);
}

function unpresskey(nK)
{
	var o = document.getElementById('cell'+nK);
	o.className = '';
}
function setfocus()
{
	document.getElementById('keycapture').focus();
}
function createdoc(name,shortcut,imp,doc)
{
return '<div id="divdocname" class="docname">'+name+'</div>'+
'<div id="divdocshortcut" class="docshortcut">'+shortcut+'</div>'+
'<div id="divdocimp" class="docimp">'+imp+'</div>'+
'<div id="divdocdoc" class="docdoc">'+doc+'</div>';

}
function search(e)
{
	if (!e) var e = window.event;
	if (e.keyCode!=13) return;


}
document.onclick = setfocus;


</script>
<link rel="stylesheet" type="text/css" href="keyboard.css" />
</head>
<body onload="setfocus();">
<span id="notify">Press Keys =&gt;</span><input onkeydown="return recordkey(event);" onkeyup="return recordkeyup(event);" id="keycapture" style="color:white;" />
<span id="notify">Search:</span><input onkeydown="search();" />
<button onclick="test();">Wow</button><button onclick="changei();">Change i</button>
<textarea id="debug"></textarea>

<div id="divout"><!--Keyboard here--></div> 
<br/><br/>
<div id="divdoc"><!--Documentation here--></div>

<script language="JavaScript">
drawKeyboard(0.3,100,'standard');
</script>
<div id="divmode"><!--Mode information -->
<b>Modes</b>
<script language="JavaScript">
function rendermodes()
{
	if (! Modes) return;
	var m = Modes();
	document.write('<table border="0">');
	for (var i=0; i<m.length; i++)
	{
		if (i%3==0) document.write('</tr><tr>');
		var id = 'rad' + m[i][1];
		var cmd = ' onclick = "loadmode('+m[i][1] + ')" ';
		document.write('<td class="mode"><input type="radio" value="' + m[i][1] + '" name="mode" id="' + id + '" '+cmd+ (i==0?' checked ': '') + ' ><label for="' + id + '" style="padding-left:0px" '+cmd+' >'+m[i][0] + '</label></td>');
	
	}
	document.write('</tr></table>');
	
	loadmode(m[0][1]); //Load first mode as default
}
rendermodes();
</script>
</div>
<!--<br><textarea id="out" rows="3"></textarea>-->
</body>
</html>